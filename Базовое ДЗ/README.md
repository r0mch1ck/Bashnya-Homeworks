Домашнее задание по уроку "Основы Pandas, знакомство с данными"

> ​В этом и следующих домашних заданиях мы будем использовать сквозной пример и работать с одними и теми же данными. Представьте себе, что вы - продуктовый аналитик популярной мобильной игры Clash of Clowns. Не будем подробно описывать механику игры (она не будет важна для выполнения задач). Важным для нас является та информация, которая собирается о пользователях:
> 
> - Журнал посещений (сессий) - каждое посещение пользователя регистрируется в специальной аналитической системе;
>     
> - Журнал покупок - все покупки, совершаемые пользователями, регистрируются в аналитической системе, поскольку нам важно знать насколько хорошо монетизируется бизнес;
>     
> - Журнал событий - во время каждого пещения для пользователя регистрируются важнейшие типы событий. Наример, важными событиями являются совершение покупки или прохождение учебного уровня в игре (так называемый "туториал/tutorial").
>     
>     В этом домашнем задании вы исследуете некоторые из событий и посмотрите на журнал посещений.
>     

С помощью markdown-ячеек задайте заголовки подразделов для заданий.

# Задание 1. Загрузка данных из файлов

В приложении к заданию даны два файла:

- hw_lesson02_tutorial_completed.csv содержит данные о том, когда новые игроки завершали учебный уровень в игре (при этом игра регистрирует аналитическое событие tutorial_completed) и сколько времени они потратили на прохождение;
- hw_lesson02_sessions.xlsx содержит данные журнала посещений.

Файл hw_lesson02_tutorial_completed содержит колонки:

- user_id - уникальный идентификатор пользователя;
- event_name - название события;
- event_dt - дата и время события;
- duration_sec - длительность прохождения учебного уровня в секундах.

Файл hw_lesson02_sessions содержит колонки:

- user_id - уникальный идентификатор пользователя;
    
- region - географический регион, из котого был совершен визит пользователя;
    
- device - устройство, с которого был совершен визит пользователя;
    
- channel - рекламный канал из которого был совершен визит пользователя;
    
- session_duration - длительность сессии в секундах;
    
- session_start - дата и время начала визита пользователя.
    

Прочитайте данные из файлов, создайте датафреймы для посещений и учебных игр.

- ​Исследуйте данные с помощью команд info и head;
- Изучите категориальные переменные (например, географический регион). Какие значения могут принимать категориальные переменные?
- Рассчитайте минимальные и максимальные даты в обоих фреймах. Какой временной интервал покрывают полученные данные?
- Опишите ваши выводы и наблюдения.

# Задание 2. Описательная статистика

Исследуйте колонки duration_sec и session_duration:

- Рассчитайте для каждой из колонок среднее, среднеквадратическое отклонение, медиану;
- Рассчитайте для каждой из колонок среднее и медиану в минутах;
- Постройте гистограммы для колонок duration_sec и session_duration. Опишите, какие распределения вы видите на гистограммах;
- Опишите ваши выводы и наблюдения.

# Задание 3. Исследование выбросов

Исследуйте колонки duration_sec и session_duration на наличие выбросов:

- Постройте диаграммы размаха для обеих колонок;
    
- Для каждой колонки рассчитайте 99% перцентиль;
    
- Опишите ваши выводы и наблюдения.
    

# Задание 4. Сохранение данных в файл

- ​С помощью query отфильтруйте из таблиц визитов и учебных игр выбросы по столбцам duration_sec и session_duration.
- Сохраните получившиеся дата-фреймы в csv-файлы.

# Задание 5. Фильтрация выбросов с помощью функции

Напишите функцию filter_outliers, которая принимает на вход:

- Датафрейм;
- Наименование столбца, по которому в этом датафрейме нужно найти выбросы;
- Значения границы выбросов для расчета перцентиля.

Функция должна убирать из фрейма все выбросы по указанному столбцу и возвращать отфильтрованный датафрейм. Например, вызов функции `filter_outliers(sessions, 'session_duration', 0.95)` должен вернуть копию фрейма sessions, из которой будут вычищены все выбросы по столбцу session_duration, превышающие quantile(0.95).